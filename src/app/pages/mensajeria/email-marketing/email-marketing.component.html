<div class="flex flex-col min-h-screen bg-gray-50" style="font-family: 'Barlow', sans-serif;">
  <!-- Header -->
  <app-navbar class="sticky top-0 z-10"></app-navbar>

  <div class="flex flex-1 overflow-hidden">
    <!-- Sidebar -->
    <app-sidebar-negocio></app-sidebar-negocio>

    <!-- Main Content -->
    <main class="flex overflow-y-auto bg-gray-50 lg:ml-64">
      <div class="mx-auto p-4 md:p-6 max-w-7xl">
        <!-- Page Header -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
          <div>
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900">Email Marketing</h1>
            <p class="text-gray-600 mt-1">Gestiona y analiza tus campañas de correo electrónico</p>
          </div>
          <div class="flex items-center gap-3">
            <button (click)="changeTab('reports')" 
                    class="flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
              <i class="fas fa-chart-line text-blue-600"></i>
              Ver reportes
            </button>
            <button (click)="changeTab('compose')" 
                    class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-2.5 rounded-lg hover:opacity-90 transition-all flex items-center gap-2 shadow-md hover:shadow-lg">
              <i class="fas fa-plus"></i> Nueva Campaña
            </button>
          </div>
        </div>

        <!-- Email Dashboard -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
          <!-- Tabs Navigation -->
          <div class="border-b border-gray-200">
            <nav class="flex overflow-x-auto -mb-px">
              <button (click)="changeTab('inbox')" 
                      class="px-5 py-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors"
                      [class.border-blue-600.text-blue-600]="currentView === 'inbox'"
                      [class.border-transparent.text-gray-500.hover:text-gray-700.hover:border-gray-300]="currentView !== 'inbox'">
                <i class="fas fa-inbox mr-2"></i> Bandeja
                <span *ngIf="unreadCount > 0" class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">
                  {{ unreadCount }} nuevos
                </span>
              </button>
              <button (click)="changeTab('sent')" 
                      class="px-5 py-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors"
                      [class.border-blue-600.text-blue-600]="currentView === 'sent'"
                      [class.border-transparent.text-gray-500.hover:text-gray-700.hover:border-gray-300]="currentView !== 'sent'">
                <i class="fas fa-paper-plane mr-2"></i> Enviados
                <span class="ml-2 text-gray-500 text-xs">{{ sentCount }}</span>
              </button>
              <button (click)="changeTab('compose')" 
                      class="px-5 py-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors"
                      [class.border-blue-600.text-blue-600]="currentView === 'compose'"
                      [class.border-transparent.text-gray-500.hover:text-gray-700.hover:border-gray-300]="currentView !== 'compose'">
                <i class="fas fa-edit mr-2"></i> Redactar
              </button>
              <button (click)="changeTab('templates')" 
                      class="px-5 py-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors"
                      [class.border-blue-600.text-blue-600]="currentView === 'templates'"
                      [class.border-transparent.text-gray-500.hover:text-gray-700.hover:border-gray-300]="currentView !== 'templates'">
                <i class="fas fa-file-alt mr-2"></i> Plantillas
              </button>
              <button (click)="changeTab('contacts')" 
                      class="px-5 py-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors"
                      [class.border-blue-600.text-blue-600]="currentView === 'contacts'"
                      [class.border-transparent.text-gray-500.hover:text-gray-700.hover:border-gray-300]="currentView !== 'contacts'">
                <i class="fas fa-users mr-2"></i> Contactos
                <span class="ml-2 text-gray-500 text-xs">{{ contactsCount | number }}</span>
              </button>
            </nav>
          </div>

          <!-- Content Area -->
          <div class="p-0">
            <!-- Inbox/Sent View -->
            <div *ngIf="currentView === 'inbox' || currentView === 'sent'" class="flex flex-col md:flex-row divide-y md:divide-y-0 md:divide-x divide-gray-200">
              <!-- Email List -->
              <div class="w-full md:w-1/3 lg:w-1/4 h-[calc(100vh-220px)] overflow-y-auto">
                <!-- Search and Filters -->
                <div class="p-4 bg-gray-50 border-b border-gray-200">
                  <div class="relative">
                    <input type="text" placeholder="Buscar correos..." 
                          class="w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all"
                          [(ngModel)]="searchTerm" (input)="filterEmails()">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                  </div>
                  <div class="flex gap-2 mt-3 overflow-x-auto pb-1">
                    <button *ngFor="let filter of filters" 
                            (click)="applyFilter(filter.key)"
                            class="text-xs px-3 py-1.5 rounded-full whitespace-nowrap transition-colors"
                            [class.bg-blue-100.text-blue-600]="currentFilter === filter.key"
                            [class.bg-gray-100.text-gray-600.hover:bg-gray-200]="currentFilter !== filter.key">
                      {{ filter.label }}
                    </button>
                  </div>
                </div>

                <!-- Email Items -->
                <div class="divide-y divide-gray-200">
                  <div *ngFor="let email of filteredEmails" 
                      class="p-4 hover:bg-blue-50 cursor-pointer transition-colors email-item"
                      [class.bg-blue-50]="selectedEmail?.id === email.id"
                      [class.unread]="!email.read && currentView === 'inbox'"
                      (click)="selectEmail(email)">
                    <div class="flex items-start gap-3">
                      <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 mt-1" 
                          [ngClass]="email.color">
                        <i class="fas text-white" [class]="email.icon"></i>
                      </div>
                      <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                          <h4 class="font-semibold text-gray-800 truncate">
                            {{ currentView === 'inbox' ? email.from : (email.to ?? '' | truncate:20) }}

                          </h4>
                          <span class="text-xs text-gray-500 whitespace-nowrap ml-2">{{ email.date | date:'shortTime' }}</span>
                        </div>
                        <p class="font-medium text-gray-800 mt-1 truncate">{{ email.subject }}</p>
                        <p class="text-sm text-gray-500 truncate mt-1">{{ email.preview }}</p>
                        <div *ngIf="email.attachments && email.attachments.length > 0" class="flex items-center gap-2 mt-2">
                          <i class="fas fa-paperclip text-gray-400 text-xs"></i>
                          <span class="text-xs text-gray-500">{{ email.attachments.length }} adjunto(s)</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div *ngIf="filteredEmails.length === 0" class="p-8 text-center">
                    <i class="fas fa-inbox text-4xl text-gray-300 mb-4"></i>
                    <p class="text-gray-500">No hay correos en esta carpeta</p>
                    <button *ngIf="currentView === 'sent'" (click)="changeTab('compose')" 
                            class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors">
                      <i class="fas fa-plus mr-1"></i> Redactar nuevo correo
                    </button>
                  </div>
                </div>
              </div>

              <!-- Email Detail View -->
              <div *ngIf="selectedEmail" class="flex-1 h-[calc(100vh-220px)] overflow-y-auto bg-white">
                <div class="sticky top-0 bg-white z-10 border-b border-gray-200 p-4">
                  <div class="flex items-center justify-between">
                    <h2 class="text-xl font-bold text-gray-900">{{ selectedEmail.subject }}</h2>
                    <div class="flex gap-2">
                      <button (click)="replyEmail()" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full">
                        <i class="fas fa-reply"></i>
                      </button>
                      <button (click)="forwardEmail()" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full">
                        <i class="fas fa-share"></i>
                      </button>
                      <button (click)="deleteEmail()" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full">
                        <i class="fas fa-trash-alt"></i>
                      </button>
                      <div class="relative">
                        <button (click)="toggleEmailActions()" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full">
                          <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div *ngIf="showEmailActions" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-20 border border-gray-200">
                          <div class="py-1">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Marcar como importante</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Archivar</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Mover a carpeta</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="flex items-start gap-4 mt-4">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 mt-1" 
                        [ngClass]="selectedEmail.color">
                      <i class="fas text-white" [class]="selectedEmail.icon"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                      <div class="flex items-center justify-between">
                        <div>
                          <p class="font-semibold text-gray-900">{{ currentView === 'inbox' ? selectedEmail.from : 'Tú' }}</p>
                          <p *ngIf="currentView === 'inbox'" class="text-sm text-gray-500">{{ selectedEmail.email }}</p>
                        </div>
                        <div class="text-sm text-gray-500 whitespace-nowrap ml-4">
                          {{ selectedEmail.date | date:'medium' }}
                        </div>
                      </div>
                      <div class="mt-1 text-sm text-gray-500">
                        Para: <span class="text-gray-700">{{ currentView === 'inbox' ? 'mí' : selectedEmail.to }}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Email Content -->
                <div class="p-6">
                  <div class="prose max-w-none" [innerHTML]="selectedEmail.body"></div>
                  
                  <!-- Attachments -->
                  <div *ngIf="selectedEmail.attachments && selectedEmail.attachments.length > 0" class="mt-8 pt-6 border-t border-gray-200">
                    <h4 class="text-sm font-medium text-gray-700 mb-4">Adjuntos ({{ selectedEmail.attachments.length }})</h4>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                      <div *ngFor="let attachment of selectedEmail.attachments" 
                          class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="w-12 h-12 flex items-center justify-center rounded-lg bg-gray-100 text-gray-500">
                          <i class="fas fa-file-pdf text-red-500" *ngIf="attachment.type === 'pdf'"></i>
                          <i class="fas fa-file-image text-blue-500" *ngIf="attachment.type === 'image'"></i>
                          <i class="fas fa-file-excel text-green-500" *ngIf="attachment.type === 'spreadsheet'"></i>
                          <i class="fas fa-file-word text-blue-600" *ngIf="attachment.type === 'document'"></i>
                          <i class="fas fa-file-archive text-yellow-500" *ngIf="attachment.type === 'archive'"></i>
                        </div>
                        <div class="min-w-0">
                          <p class="text-sm font-medium truncate">{{ attachment.name }}</p>
                          <p class="text-xs text-gray-500">{{ attachment.size }}</p>
                        </div>
                        <button (click)="downloadAttachment(attachment)" 
                                class="ml-auto text-gray-400 hover:text-gray-600 transition-colors">
                          <i class="fas fa-download"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Reply Area -->
                <div class="p-4 border-t border-gray-200 bg-gray-50">
                  <div class="flex items-center gap-3 mb-4 overflow-x-auto pb-2">
                    <button (click)="replyEmail()" class="text-sm px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2">
                      <i class="fas fa-reply"></i> Responder
                    </button>
                    <button (click)="replyAll()" class="text-sm px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2">
                      <i class="fas fa-reply-all"></i> Responder a todos
                    </button>
                    <button (click)="forwardEmail()" class="text-sm px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2">
                      <i class="fas fa-share"></i> Reenviar
                    </button>
                  </div>
                  
                  <div class="bg-white rounded-lg border border-gray-300 overflow-hidden">
                    <div class="border-b border-gray-200 p-2 bg-gray-50 flex items-center gap-1 overflow-x-auto">
                      <button (click)="formatText('bold')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-bold"></i>
                      </button>
                      <button (click)="formatText('italic')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-italic"></i>
                      </button>
                      <button (click)="formatText('link')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-link"></i>
                      </button>
                      <button class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-image"></i>
                      </button>
                      <button class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-paperclip"></i>
                      </button>
                      <div class="border-l border-gray-200 h-6 mx-1"></div>
                      <button class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-undo-alt"></i>
                      </button>
                      <button class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                        <i class="fas fa-redo-alt"></i>
                      </button>
                    </div>
                    <textarea #replyText rows="4" class="w-full border-0 focus:ring-0 text-gray-700 p-4" 
                              placeholder="Escribe tu respuesta aquí..."></textarea>
                    <div class="border-t border-gray-200 p-3 flex justify-between items-center">
                      <button class="text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1">
                        <i class="fas fa-paperclip"></i> Adjuntar archivos
                      </button>
                      <div class="flex gap-2">
                        <button (click)="discardReply()" class="text-sm px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                          Descartar
                        </button>
                        <button (click)="sendReply(replyText.value)" 
                                class="text-sm px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                          <i class="far fa-paper-plane"></i> Enviar
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Empty State -->
              <div *ngIf="!selectedEmail && filteredEmails.length > 0" class="hidden md:flex flex-1 items-center justify-center bg-gray-50">
                <div class="text-center p-8 max-w-md">
                  <i class="fas fa-envelope-open-text text-5xl text-gray-300 mb-4"></i>
                  <h4 class="text-lg font-medium text-gray-700">Selecciona un correo</h4>
                  <p class="text-gray-500 mt-2">Haz clic en un correo de la lista para ver su contenido</p>
                </div>
              </div>
            </div>

            <!-- Compose View -->
            <div *ngIf="currentView === 'compose'" class="p-6">
              <div class="bg-white rounded-xl shadow-sm border border-gray-200">
                <div class="border-b border-gray-200 p-4">
                  <div class="flex items-center justify-between">
                    <h3 class="text-lg font-bold text-gray-900">Nuevo Mensaje</h3>
                    <div class="flex gap-2">
                      <button (click)="saveDraft()" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full">
                        <i class="fas fa-save"></i>
                      </button>
                      <button (click)="changeTab('inbox')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </div>
                </div>
                
                <div class="p-6">
                  <form (ngSubmit)="sendComposedEmail()">
                    <div class="mb-4">
                      <label class="block text-sm font-medium text-gray-700 mb-1">Para</label>
                      <input type="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all" 
                            placeholder="Correo del destinatario" [(ngModel)]="newEmail.to" name="to" required>
                    </div>
                    
                    <div class="mb-4">
                      <label class="block text-sm font-medium text-gray-700 mb-1">Asunto</label>
                      <input type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all" 
                            placeholder="Asunto del mensaje" [(ngModel)]="newEmail.subject" name="subject" required>
                    </div>
                    
                    <div class="border border-gray-300 rounded-lg overflow-hidden">
                      <div class="border-b border-gray-200 p-2 bg-gray-50 flex items-center gap-1 overflow-x-auto">
                        <button type="button" (click)="formatText('bold')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-bold"></i>
                        </button>
                        <button type="button" (click)="formatText('italic')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-italic"></i>
                        </button>
                        <button type="button" (click)="formatText('link')" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-link"></i>
                        </button>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-image"></i>
                        </button>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-paperclip"></i>
                        </button>
                        <div class="border-l border-gray-200 h-6 mx-1"></div>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-undo-alt"></i>
                        </button>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-redo-alt"></i>
                        </button>
                        <div class="border-l border-gray-200 h-6 mx-1"></div>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-paragraph"></i>
                        </button>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-list-ul"></i>
                        </button>
                        <button type="button" class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded">
                          <i class="fas fa-list-ol"></i>
                        </button>
                      </div>
                      <textarea #composeBody rows="12" class="w-full border-0 focus:ring-0 text-gray-700 p-4" 
                                placeholder="Escribe tu mensaje aquí..." [(ngModel)]="newEmail.body" name="body" required></textarea>
                      <div class="border-t border-gray-200 p-3 flex justify-between items-center">
                        <div class="flex gap-2">
                          <button type="button" class="text-sm px-3 py-1.5 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-1">
                            <i class="fas fa-paperclip"></i> Adjuntar
                          </button>
                          <button type="button" class="text-sm px-3 py-1.5 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-1">
                            <i class="fas fa-image"></i> Insertar imagen
                          </button>
                        </div>
                        <div class="flex gap-2">
                          <button type="button" (click)="discardCompose()" class="text-sm px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                            Descartar
                          </button>
                          <button type="submit" 
                                  class="text-sm px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:opacity-90 transition-all flex items-center gap-2 shadow-md hover:shadow-lg">
                            <i class="far fa-paper-plane"></i> Enviar
                          </button>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>

              <!-- Email Templates -->
              <div class="mt-8">
                <h3 class="text-lg font-bold text-gray-900 mb-4">Plantillas de Email</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                  <div *ngFor="let template of emailTemplates" 
                      (click)="applyTemplate(template.key)"
                      class="border border-gray-200 rounded-lg overflow-hidden cursor-pointer hover:shadow-md transition-all">
                    <div class="h-40 flex items-center justify-center" [ngClass]="template.bgColor">
                      <i class="fas text-4xl" [ngClass]="template.icon"></i>
                    </div>
                    <div class="p-4">
                      <h4 class="font-semibold text-gray-900">{{ template.title }}</h4>
                      <p class="text-sm text-gray-500 mt-1">{{ template.description }}</p>
                      <button class="mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium">
                        Usar plantilla <i class="fas fa-arrow-right ml-1"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Reports View -->
            <div *ngIf="currentView === 'reports'" class="p-6">
              <!-- Stats Cards -->
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div *ngFor="let stat of emailStats" class="bg-white p-5 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm text-gray-500">{{ stat.label }}</p>
                      <h3 class="text-2xl font-bold mt-1">{{ stat.value }}</h3>
                      <p class="text-sm mt-1 flex items-center"
                        [class.text-green-600]="stat.trend === 'up'"
                        [class.text-red-600]="stat.trend === 'down'">
                        <i class="fas" [class.fa-arrow-up]="stat.trend === 'up'" [class.fa-arrow-down]="stat.trend === 'down'" class="mr-1"></i>
                        {{ stat.change }} desde ayer
                      </p>
                    </div>
                    <div class="w-12 h-12 rounded-full flex items-center justify-center" [ngClass]="stat.bgColor">
                      <i class="fas text-xl" [ngClass]="stat.icon" [class.text-white]="true"></i>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Main Chart -->
              <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-8">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                  <h3 class="text-lg font-bold text-gray-900">Rendimiento de campañas</h3>
                  <div class="flex gap-2 mt-3 sm:mt-0">
                    <select class="text-sm border border-gray-300 rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-blue-100 focus:border-blue-500">
                      <option>Últimos 7 días</option>
                      <option>Últimos 30 días</option>
                      <option>Este mes</option>
                      <option>Este trimestre</option>
                    </select>
                    <button class="text-sm px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors">
                      Exportar
                    </button>
                  </div>
                </div>
                <div class="h-80">
                  <!-- Chart would go here -->
                  <div class="flex items-center justify-center h-full bg-gray-50 rounded-lg border border-gray-200 border-dashed">
                    <p class="text-gray-400">Gráfico de rendimiento de campañas</p>
                  </div>
                </div>
              </div>

              <!-- Two Column Layout -->
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Campaign Performance -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                  <h3 class="text-lg font-bold text-gray-900 mb-6">Campañas recientes</h3>
                  <div class="space-y-4">
                    <div *ngFor="let campaign of recentCampaigns" class="flex items-start">
                      <div class="w-10 h-10 rounded-full flex items-center justify-center mt-1 mr-4" [ngClass]="campaign.bgColor">
                        <i class="fas text-white" [ngClass]="campaign.icon"></i>
                      </div>
                      <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                          <h4 class="font-semibold text-gray-900">{{ campaign.name }}</h4>
                          <span class="text-xs text-gray-500 whitespace-nowrap ml-2">{{ campaign.date }}</span>
                        </div>
                        <p class="text-sm text-gray-500 mt-1">{{ campaign.subject }}</p>
                        <div class="mt-2 flex items-center gap-4">
                          <div class="flex items-center gap-1 text-sm text-gray-500">
                            <i class="fas fa-envelope-open text-blue-500"></i>
                            <span>{{ campaign.openRate }}% apertura</span>
                          </div>
                          <div class="flex items-center gap-1 text-sm text-gray-500">
                            <i class="fas fa-mouse-pointer text-indigo-500"></i>
                            <span>{{ campaign.clickRate }}% clics</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <button class="mt-6 w-full py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
                    Ver todas las campañas
                  </button>
                </div>

                <!-- Subscriber Growth -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                  <h3 class="text-lg font-bold text-gray-900 mb-6">Crecimiento de suscriptores</h3>
                  <div class="h-64 mb-4">
                    <!-- Chart would go here -->
                    <div class="flex items-center justify-center h-full bg-gray-50 rounded-lg border border-gray-200 border-dashed">
                      <p class="text-gray-400">Gráfico de crecimiento</p>
                    </div>
                  </div>
                  <div class="grid grid-cols-3 gap-4 text-center">
                    <div class="p-3 bg-gray-50 rounded-lg">
                      <p class="text-sm text-gray-500">Total</p>
                      <p class="font-bold text-gray-900">{{ contactsCount | number }}</p>
                    </div>
                    <div class="p-3 bg-gray-50 rounded-lg">
                      <p class="text-sm text-gray-500">Nuevos (7d)</p>
                      <p class="font-bold text-gray-900">+{{ newSubscribers7d | number }}</p>
                    </div>
                    <div class="p-3 bg-gray-50 rounded-lg">
                      <p class="text-sm text-gray-500">Bajas (7d)</p>
                      <p class="font-bold text-gray-900">-{{ unsubscribed7d | number }}</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Top Performing Campaigns -->
              <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                  <h3 class="text-lg font-bold text-gray-900">Campañas más efectivas</h3>
                </div>
                <div class="divide-y divide-gray-200">
                  <div *ngFor="let campaign of topCampaigns" class="p-4 hover:bg-gray-50 transition-colors">
                    <div class="flex items-center">
                      <div class="w-12 h-12 rounded-lg bg-blue-50 flex items-center justify-center mr-4">
                        <i class="fas fa-envelope text-blue-600"></i>
                      </div>
                      <div class="flex-1 min-w-0">
                        <h4 class="font-semibold text-gray-900 truncate">{{ campaign.title }}</h4>
                        <p class="text-sm text-gray-500">{{ campaign.date }} · {{ campaign.recipients | number }} destinatarios</p>
                      </div>
                      <div class="text-right whitespace-nowrap ml-4">
                        <div class="flex items-center justify-end gap-4">
                          <div class="text-center">
                            <p class="font-semibold text-gray-900">{{ campaign.openRate }}%</p>
                            <p class="text-xs text-gray-500">Apertura</p>
                          </div>
                          <div class="text-center">
                            <p class="font-semibold text-gray-900">{{ campaign.clickRate }}%</p>
                            <p class="text-xs text-gray-500">Clics</p>
                          </div>
                          <div class="text-center">
                            <p class="font-semibold text-gray-900">{{ campaign.conversionRate }}%</p>
                            <p class="text-xs text-gray-500">Conversión</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="p-4 border-t border-gray-200 text-center">
                  <button class="text-sm text-blue-600 hover:text-blue-800 font-medium">
                    Ver más campañas <i class="fas fa-arrow-right ml-1"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- Templates View -->
            <div *ngIf="currentView === 'templates'" class="p-6">
              <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                <div>
                  <h3 class="text-lg font-bold text-gray-900">Plantillas de Email</h3>
                  <p class="text-gray-500 mt-1">Plantillas predefinidas para tus campañas de marketing</p>
                </div>
                <button (click)="createNewTemplate()" 
                        class="mt-4 sm:mt-0 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-2.5 rounded-lg hover:opacity-90 transition-all flex items-center gap-2 shadow-md hover:shadow-lg">
                  <i class="fas fa-plus"></i> Nueva Plantilla
                </button>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div *ngFor="let template of savedTemplates" class="border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow">
                  <div class="h-48 bg-gray-100 flex items-center justify-center relative">
                    <img [src]="template.previewImage" alt="Preview" class="absolute inset-0 w-full h-full object-cover" *ngIf="template.previewImage">
                    <i class="fas fa-envelope text-4xl text-gray-400" *ngIf="!template.previewImage"></i>
                    <div class="absolute top-3 right-3">
                      <button class="p-2 bg-white rounded-full shadow-sm hover:bg-gray-100 transition-colors">
                        <i class="fas fa-ellipsis-v text-gray-500"></i>
                      </button>
                    </div>
                  </div>
                  <div class="p-4">
                    <div class="flex items-start justify-between">
                      <div>
                        <h4 class="font-semibold text-gray-900">{{ template.name }}</h4>
                        <p class="text-sm text-gray-500 mt-1">Última modificación: {{ template.updatedAt | date:'mediumDate' }}</p>
                      </div>
                      <span class="px-2 py-1 text-xs rounded-full" 
                            [class.bg-green-100.text-green-800]="template.category === 'marketing'"
                            [class.bg-blue-100.text-blue-800]="template.category === 'transactional'"
                            [class.bg-purple-100.text-purple-800]="template.category === 'newsletter'">
                        {{ template.category | titlecase }}
                      </span>
                    </div>
                    <div class="mt-4 flex gap-2">
                      <button (click)="useTemplate(template)" class="flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm">
                        Usar
                      </button>
                      <button (click)="editTemplate(template)" class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        <i class="fas fa-pencil-alt text-gray-600"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <div *ngIf="savedTemplates.length === 0" class="text-center py-12">
                <i class="fas fa-file-alt text-4xl text-gray-300 mb-4"></i>
                <h4 class="text-lg font-medium text-gray-700">No tienes plantillas guardadas</h4>
                <p class="text-gray-500 mt-2 mb-4">Crea tu primera plantilla para agilizar tus campañas de email</p>
                <button (click)="createNewTemplate()" 
                        class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-2.5 rounded-lg hover:opacity-90 transition-all flex items-center gap-2 shadow-md hover:shadow-lg mx-auto">
                  <i class="fas fa-plus"></i> Crear Plantilla
                </button>
              </div>
            </div>

            <!-- Contacts View -->
            <div *ngIf="currentView === 'contacts'" class="p-6">
              <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                <div>
                  <h3 class="text-lg font-bold text-gray-900">Lista de Contactos</h3>
                  <p class="text-gray-500 mt-1">Gestiona tus suscriptores y listas de distribución</p>
                </div>
                <div class="flex gap-3 mt-4 sm:mt-0">
                  <button class="px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2">
                    <i class="fas fa-download"></i> Importar
                  </button>
                  <button (click)="exportContacts()" class="px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2">
                    <i class="fas fa-upload"></i> Exportar
                  </button>
                  <button (click)="createNewContact()" 
                          class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-5 py-2.5 rounded-lg hover:opacity-90 transition-all flex items-center gap-2 shadow-md hover:shadow-lg">
                    <i class="fas fa-plus"></i> Nuevo Contacto
                  </button>
                </div>
              </div>

              <!-- Contacts Table -->
              <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                <div class="p-4 border-b border-gray-200 bg-gray-50 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3">
                  <div class="relative w-full sm:w-auto">
                    <input type="text" placeholder="Buscar contactos..." 
                          class="w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all"
                          [(ngModel)]="contactSearchTerm" (input)="filterContacts()">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                  </div>
                  <div class="flex gap-2 w-full sm:w-auto">
                    <select [(ngModel)]="selectedContactList" (change)="filterContacts()"
                            class="w-full sm:w-auto text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-100 focus:border-blue-500">
                      <option value="all">Todas las listas</option>
                      <option *ngFor="let list of contactLists" [value]="list.id">{{ list.name }} ({{ list.count }})</option>
                    </select>
                    <button class="p-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors">
                      <i class="fas fa-filter text-gray-600"></i>
                    </button>
                  </div>
                </div>
                
                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          <input type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Nombre
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Email
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Listas
                        </th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Estado
                        </th>
                        <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Acciones
                        </th>
                      </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                      <tr *ngFor="let contact of filteredContacts" class="hover:bg-gray-50 transition-colors">
                        <td class="px-6 py-4 whitespace-nowrap">
                          <input type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                          <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                              <i class="fas fa-user text-blue-600"></i>
                            </div>
                            <div class="ml-4">
                              <div class="text-sm font-medium text-gray-900">{{ contact.name }}</div>
                              <div class="text-sm text-gray-500">{{ contact.company }}</div>
                            </div>
                          </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                          <div class="text-sm text-gray-900">{{ contact.email }}</div>
                          <div class="text-sm text-gray-500">{{ contact.phone }}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                          <div class="flex flex-wrap gap-1">
                            <span *ngFor="let list of contact.lists.slice(0, 2)" 
                                  class="px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800">
                              {{ list }}
                            </span>
                            <span *ngIf="contact.lists.length > 2" 
                                  class="px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800">
                              +{{ contact.lists.length - 2 }} más
                            </span>
                          </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                          <span class="px-2 py-1 text-xs rounded-full" 
                                [class.bg-green-100.text-green-800]="contact.status === 'active'"
                                [class.bg-yellow-100.text-yellow-800]="contact.status === 'pending'"
                                [class.bg-red-100.text-red-800]="contact.status === 'unsubscribed'">
                            {{ contact.status | titlecase }}
                          </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                          <button (click)="editContact(contact)" class="text-blue-600 hover:text-blue-900 mr-3">
                            <i class="fas fa-pencil-alt"></i>
                          </button>
                          <button (click)="deleteContact(contact)" class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash-alt"></i>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- Pagination -->
                <div class="px-6 py-4 border-t border-gray-200 flex items-center justify-between">
                  <div class="flex-1 flex justify-between sm:hidden">
                    <button class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                      Anterior
                    </button>
                    <button class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                      Siguiente
                    </button>
                  </div>
                  <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                    <div>
                      <p class="text-sm text-gray-700">
                        Mostrando
                        <span class="font-medium">{{ (currentContactPage - 1) * contactsPerPage + 1 }}</span>
                        a
                        <span class="font-medium">{{ Math.min(currentContactPage * contactsPerPage, filteredContacts.length) }}</span>
                        de
                        <span class="font-medium">{{ filteredContacts.length }}</span>
                        resultados
                      </p>
                    </div>
                    <div>
                      <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                        <button (click)="prevContactPage()" 
                                [disabled]="currentContactPage === 1"
                                class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                          <span class="sr-only">Anterior</span>
                          <i class="fas fa-chevron-left"></i>
                        </button>
                        <button *ngFor="let page of getContactPages()" 
                                (click)="goToContactPage(page)"
                                [class.bg-blue-50.border-blue-500.text-blue-600]="page === currentContactPage"
                                [class.bg-white.border-gray-300.text-gray-500.hover:bg-gray-50]="page !== currentContactPage"
                                class="relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                          {{ page }}
                        </button>
                        <button (click)="nextContactPage()" 
                                [disabled]="currentContactPage * contactsPerPage >= filteredContacts.length"
                                class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                          <span class="sr-only">Siguiente</span>
                          <i class="fas fa-chevron-right"></i>
                        </button>
                      </nav>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

<!-- Toast Notification -->
<div class="fixed bottom-6 right-6 z-50">
  <div *ngIf="showToast" 
       @toastAnimation
       class="flex items-center w-full max-w-xs p-4 mb-4 text-gray-500 bg-white rounded-lg shadow-lg border border-gray-200"
       role="alert">
    <div class="inline-flex items-center justify-center flex-shrink-0 w-8 h-8 rounded-lg"
         [ngClass]="{
           'text-green-500 bg-green-100': toastType === 'success',
           'text-red-500 bg-red-100': toastType === 'error',
           'text-blue-500 bg-blue-100': toastType === 'info'
         }">
      <i class="fas" 
         [class.fa-check-circle]="toastType === 'success'"
         [class.fa-exclamation-circle]="toastType === 'error'"
         [class.fa-info-circle]="toastType === 'info'"></i>
    </div>
    <div class="ml-3 text-sm font-normal">{{ toastMessage }}</div>
    <button type="button" (click)="hideToast()"
            class="ml-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex h-8 w-8">
      <span class="sr-only">Close</span>
      <i class="fas fa-times"></i>
    </button>
  </div>
</div>

<!-- Modal for New Contact -->
<div *ngIf="showContactModal" class="fixed inset-0 z-50 overflow-y-auto">
  <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <div class="fixed inset-0 transition-opacity" aria-hidden="true">
      <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
    </div>
    <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
    <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
      <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
        <div class="sm:flex sm:items-start">
          <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10">
            <i class="fas fa-user-plus text-blue-600"></i>
          </div>
          <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
            <h3 class="text-lg leading-6 font-medium text-gray-900">
              {{ editingContact ? 'Editar Contacto' : 'Nuevo Contacto' }}
            </h3>
            <div class="mt-4 space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Nombre completo</label>
                <input type="text" [(ngModel)]="newContact.name" class="w-full p-2 border border-gray-300 rounded-md">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Correo electrónico</label>
                <input type="email" [(ngModel)]="newContact.email" class="w-full p-2 border border-gray-300 rounded-md">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Listas de distribución</label>
                <select [(ngModel)]="newContact.lists" multiple class="w-full p-2 border border-gray-300 rounded-md">
                  <option *ngFor="let list of contactLists" [value]="list.id">{{ list.name }}</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
        <button type="button" (click)="saveContact()"
                class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
          Guardar
        </button>
        <button type="button" (click)="cancelContact()"
                class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
          Cancelar
        </button>
      </div>
    </div>
  </div>
</div>
</div>
