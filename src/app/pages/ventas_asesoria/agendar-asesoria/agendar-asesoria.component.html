<div class="min-h-screen bg-gradient-to-b from-gray-50 to-gray-100" style="font-family: 'Barlow', sans-serif;">
    <app-sidebar-negocio></app-sidebar-negocio>
    
    <div class="flex flex-col ml-0 lg:ml-64 transition-all duration-300">
        <app-navbar></app-navbar>
        
        <div class="p-4 md:p-8 w-full">
            <div class="mb-6 text-center">
                <h1 class="text-3xl md:text-3xl font-bold text-gray-900 mb-3">Programar Asesoría</h1>
                <p class="text-gray-600 max-w-xl mx-auto text-lg">Complete el formulario para agendar su sesión con nuestros expertos</p>
            </div>
            <div class="mb-10 px-4 w-full max-w-3xl mx-auto">
                <div class="flex items-center justify-between relative mb-6">
                    <div class="absolute top-1/3 left-0 right-0 h-1.5 bg-gray-200 z-0 transform -translate-y-1/2 mx-10"></div>
                    <div class="absolute top-1/3 left-0 h-1.5 bg-gradient-to-r mx-10 from-gray-700 to-gray-900 z-10 transform -translate-y-1/2 transition-all duration-500" 
                         [style.width]="getProgressWidth()"></div>
                    
                    <div *ngFor="let step of [1,2,3]" class="flex flex-col items-center z-20 relative">
                        <div [class]="currentStep >= step ? 
                                     'bg-gradient-to-br from-gray-800 to-gray-900 text-white border-gray-700 shadow-lg' : 
                                     'bg-white text-gray-400 border-gray-200 shadow-sm'" 
                             class="w-14 h-14 rounded-full flex items-center justify-center font-semibold border-2 mb-3 transition-all duration-300">
                            {{step}}
                        </div>
                        <span [class]="currentStep >= step ? 'text-gray-900 font-medium' : 'text-gray-400'" 
                              class="text-sm tracking-wide transition-colors">
                            {{step === 1 ? 'Información' : step === 2 ? 'Disponibilidad' : 'Confirmación'}}
                        </span>
                    </div>
                </div>
            </div>
        
            <div class="bg-white rounded-2xl border border-gray-200 overflow-hidden w-full">

                <div *ngIf="currentStep === 1" class="p-8 md:p-10">
                    <div class="w-full">
                        <div class="flex items-center mb-8">
                            <div class="w-12 h-12 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center mr-4">
                                <i class="fas fa-user text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-semibold text-gray-900">Información personal</h2>
                        </div>
                        
                        <form (ngSubmit)="nextStep()" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                           
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Nombre completo*</label>
                                    <input type="text" [(ngModel)]="formData.nombre" name="nombre" required
                                           class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Correo electrónico*</label>
                                    <input type="email" [(ngModel)]="formData.email" name="email" required
                                           class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Teléfono*</label>
                                    <input type="tel" [(ngModel)]="formData.telefono" name="telefono" required
                                           class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">WhatsApp</label>
                                    <input type="tel" [(ngModel)]="formData.whatsapp" name="whatsapp"
                                           class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Empresa/Organización*</label>
                                    <input type="text" [(ngModel)]="formData.empresa" name="empresa" required
                                           class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Cargo/Posición*</label>
                                    <input type="text" [(ngModel)]="formData.cargo" name="cargo" required
                                           class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Sector Industrial*</label>
                                    <select [(ngModel)]="formData.sector" name="sector" required
                                            class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                        <option value="">Seleccione un sector</option>
                                        <option value="tecnologia">Tecnología</option>
                                        <option value="manufactura">Manufactura</option>
                                        <option value="servicios">Servicios</option>
                                        <option value="comercio">Comercio</option>
                                        <option value="salud">Salud</option>
                                        <option value="educacion">Educación</option>
                                    </select>
                                </div>
                                
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Tamaño de Empresa*</label>
                                    <select [(ngModel)]="formData.tamanoEmpresa" name="tamanoEmpresa" required
                                            class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-gray-400 focus:ring-2 focus:ring-gray-100 text-gray-900 placeholder-gray-300 transition-all hover:border-gray-300">
                                        <option value="">Seleccione tamaño</option>
                                        <option value="micro">Micro (1-10 empleados)</option>
                                        <option value="pequena">Pequeña (11-50 empleados)</option>
                                        <option value="mediana">Mediana (51-250 empleados)</option>
                                        <option value="grande">Grande (251+ empleados)</option>
                                    </select>
                                </div>
                            </div>    <!-- Checkbox de términos -->
                            <div class="flex items-start mt-4">
                                <div class="flex items-center h-5">
                                    <input id="terms" name="terms" type="checkbox" [(ngModel)]="formData.aceptaTerminos" required
                                           class="focus:ring-gray-500 h-4 w-4 text-gray-700 border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="terms" class="font-medium text-gray-700">Acepto los términos y condiciones*</label>
                                    <p class="text-gray-500">Al continuar, aceptas nuestra política de privacidad y términos de servicio.</p>
                                </div>
                            </div>
                            
                            <!-- Botón -->
                            <div class="pt-4 flex justify-end">
                                <button type="submit"
                                        class="bg-gradient-to-r from-gray-800 to-gray-900 hover:from-gray-700 hover:to-gray-800 text-white font-medium py-3 px-10 rounded-xl transition-all duration-200 shadow-md hover:shadow-lg flex items-center gap-2">
                                    Continuar
                                    <i class="fas fa-arrow-right text-sm"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                
                <div *ngIf="currentStep === 2" class="p-8 md:p-10">
                    <div class="w-full">
                        <div class="flex items-center mb-8">
                            <div class="w-12 h-12 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center mr-4">
                                <i class="fas fa-calendar-day text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-semibold text-gray-900">Selecciona fecha y hora</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                           
                            <div class="space-y-4">
                                <h3 class="text-lg font-medium text-gray-900">Selecciona un día disponible</h3>
                                
                                <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm">
                                
                                    <div class="flex items-center justify-between mb-5">
                                        <button (click)="previousMonth()" class="p-2 rounded-lg hover:bg-gray-100 text-gray-700 hover:text-gray-900 transition-colors">
                                            <i class="fas fa-chevron-left"></i>
                                        </button>
                                        <h4 class="font-semibold text-gray-900">{{currentMonth | date:'MMMM yyyy' | titlecase}}</h4>
                                        <button (click)="nextMonth()" class="p-2 rounded-lg hover:bg-gray-100 text-gray-700 hover:text-gray-900 transition-colors">
                                            <i class="fas fa-chevron-right"></i>
                                        </button>
                                    </div>
                                    
                                    <!-- Días de la semana -->
                                    <div class="grid grid-cols-7 gap-1 mb-3">
                                        <div *ngFor="let day of ['L', 'M', 'M', 'J', 'V', 'S', 'D']" 
                                             class="text-xs text-gray-500 font-medium text-center py-2">
                                            {{day}}
                                        </div>
                                    </div>
                                    
                                    <!-- Días del mes -->
                                    <div class="grid grid-cols-7 gap-1">
                                        <div *ngFor="let day of daysInMonth" 
                                             [class]="getDayClass(day)"
                                             (click)="selectDate(day)"
                                             class="h-12 flex items-center justify-center  rounded-lg text-sm font-medium cursor-pointer transition-all">
                                            {{day.date.getDate()}}
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Leyenda mejorada -->
                                <div class="mt-4 flex flex-wrap gap-4">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-gray-700 mr-2"></div>
                                        <span class="text-xs text-gray-600">Disponible</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-gray-300 mr-2"></div>
                                        <span class="text-xs text-gray-600">No disponible</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 rounded-full bg-gray-100 border border-gray-400 mr-2"></div>
                                        <span class="text-xs text-gray-600">Seleccionado</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Panel de Horarios mejorado -->
                            <div class="space-y-6">
                                <!-- Fecha seleccionada mejorada -->
                                <div *ngIf="formData.fecha" class="bg-gray-100 p-5 rounded-xl border border-gray-200">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-3">
                                            <div class="bg-white p-3 rounded-lg shadow-xs border border-gray-200">
                                                <i class="fas fa-calendar-day text-gray-600"></i>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-600 mb-1">Fecha seleccionada</p>
                                                <p class="font-semibold text-gray-900">
                                                    {{formData.fecha | date:'EEEE dd/MM/yyyy' | titlecase}}
                                                </p>
                                            </div>
                                        </div>
                                        <button (click)="clearDateSelection()" 
                                                class="text-gray-500 hover:text-gray-700 transition-colors p-1">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Horarios mejorados -->
                                <div *ngIf="formData.fecha" class="space-y-4">
                                    <label class="block text-lg font-medium text-gray-900">Horarios disponibles*</label>
                                    
                                    <div *ngIf="loadingHours" class="flex justify-center py-8">
                                        <div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-gray-700"></div>
                                    </div>
                                    
                                    <div *ngIf="!loadingHours" class="grid grid-cols-3 gap-3">
                                        <button *ngFor="let time of availableTimeSlots" 
                                                type="button"
                                                [class]="getTimeSlotClass(time)"
                                                (click)="selectTimeSlot(time)"
                                                [disabled]="isTimeSlotDisabled(time)"
                                                class="py-3 px-2 rounded-lg border transition-all duration-200 hover:shadow-sm text-sm font-medium flex items-center justify-center">
                                            {{time}}
                                            <i *ngIf="formData.hora === time" class="fas fa-check ml-1 text-xs"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Modalidad mejorada -->
                                <div class="space-y-4">
                                    <label class="block text-lg font-medium text-gray-900">Tipo de asesoría*</label>
                                    <div class="space-y-3">
                                        <div *ngFor="let mod of modalidades" 
                                             (click)="formData.modalidad = mod.value"
                                             [class]="formData.modalidad === mod.value ? 
                                                     'border-gray-300 bg-gray-100' : 
                                                     'border-gray-200 hover:border-gray-300 bg-white'"
                                             class="p-4 rounded-lg border cursor-pointer transition-all duration-200">
                                            <div class="flex items-start gap-3">
                                                <div [class]="formData.modalidad === mod.value ? 
                                                             'bg-gray-700 border-gray-700' : 
                                                             'border-gray-300 bg-white'"
                                                     class="w-5 h-5 rounded-full border-2 flex-shrink-0 mt-0.5 flex items-center justify-center">
                                                    <i *ngIf="formData.modalidad === mod.value" class="fas fa-check text-white text-[10px]"></i>
                                                </div>
                                                <div>
                                                    <span class="text-sm font-semibold text-gray-900 block">{{mod.label}}</span>
                                                    <span class="text-xs text-gray-500 mt-1 block">{{mod.description}}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Navegación mejorada -->
                                <div class="pt-6 mt-6 border-t border-gray-200 flex justify-between">
                                    <button type="button" (click)="prevStep()"
                                            class="px-6 py-3 border border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-all duration-200 flex items-center gap-2 hover:border-gray-300">
                                        <i class="fas fa-arrow-left"></i>
                                        Regresar
                                    </button>
                                    <button type="button" (click)="nextStep()" 
                                            [disabled]="!formData.fecha || !formData.hora || !formData.modalidad"
                                            [class]="(!formData.fecha || !formData.hora || !formData.modalidad ? 
                                                     'bg-gray-100 cursor-not-allowed text-gray-400' : 
                                                     'bg-gradient-to-r from-gray-800 to-gray-900 hover:from-gray-700 hover:to-gray-800 text-white') + 
                                                     ' font-medium py-3 px-6 rounded-lg transition-all duration-200 flex items-center gap-2'">
                                        Continuar
                                        <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Paso 3: Confirmación mejorada -->
                <div *ngIf="currentStep === 3" class="p-8 md:p-10">
                    <div class="w-full">
                        <div class="flex items-center mb-8">
                            <div class="w-12 h-12 rounded-full bg-gray-100 text-gray-700 flex items-center justify-center mr-4">
                                <i class="fas fa-check-circle text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-semibold text-gray-900">Revisa y confirma tu asesoria</h2>
                        </div>
                        
                        <!-- Información importante mejorada -->
                        <div class="bg-gray-100 p-6 rounded-xl border border-gray-200 mb-8">
                            <div class="flex items-start gap-4">
                                <div class="bg-gray-200 p-2 rounded-full">
                                    <i class="fas fa-info-circle text-gray-600 text-lg"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-800 leading-relaxed">
                                        <span class="font-medium text-gray-700">Importante:</span> Esta asesoría forma parte de un modulo o hito suscrito. Recibirás un correo de confirmación con los detalles de tu sesión y el enlace de acceso si es virtual.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Resumen de datos personales mejorado -->
                            <div class="space-y-4">
                                <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider flex items-center gap-3">
                                    <i class="fas fa-user text-gray-500 text-lg"></i>
                                    Tus datos
                                </h3>
                                <div class="bg-gray-100 p-6 rounded-xl border border-gray-200 space-y-5">
                                    <div class="flex items-start gap-4">
                                        <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                            <i class="fas fa-user text-gray-600"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs text-gray-600 mb-1">Nombre completo</p>
                                            <p class="text-sm font-semibold text-gray-900">{{formData.nombre || '-'}}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                            <i class="fas fa-envelope text-gray-600"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs text-gray-600 mb-1">Correo electrónico</p>
                                            <p class="text-sm font-semibold text-gray-900">{{formData.email || '-'}}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                            <i class="fas fa-phone text-gray-600"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs text-gray-600 mb-1">Teléfono</p>
                                            <p class="text-sm font-semibold text-gray-900">{{formData.telefono || '-'}}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                            <i class="fas fa-building text-gray-600"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs text-gray-600 mb-1">Empresa</p>
                                            <p class="text-sm font-semibold text-gray-900">{{formData.empresa || '-'}}</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-4">
                                        <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                            <i class="fas fa-briefcase text-gray-600"></i>
                                        </div>
                                        <div>
                                            <p class="text-xs text-gray-600 mb-1">Cargo/Posición</p>
                                            <p class="text-sm font-semibold text-gray-900">{{formData.cargo || '-'}}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Resumen de asesoría mejorado -->
                            <div class="space-y-4">
                                <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wider flex items-center gap-3">
                                    <i class="fas fa-calendar-check text-gray-500 text-lg"></i>
                                    Detalles de la asesoría
                                </h3>
                                <div class="bg-gray-100 p-6 rounded-xl border border-gray-200 space-y-5">
                                    
                                    
                                    <div class="grid grid-cols-2 gap-5">
                                        <div class="flex items-start gap-4">
                                            <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                                <i class="fas fa-clock text-gray-600"></i>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-600 mb-1">Hora</p>
                                                <p class="text-sm font-semibold text-gray-900">{{formData.hora || '-'}}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-start gap-4">
                                            <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                                <i class="fas fa-calendar-day text-gray-600"></i>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-600 mb-1">Fecha</p>
                                                <p class="text-sm font-semibold text-gray-900">{{formData.fecha ? (formData.fecha | date:'dd/MM/yyyy') : '-'}}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-start gap-4">
                                            <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                                <i class="fas fa-laptop-house text-gray-600"></i>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-600 mb-1">Modalidad</p>
                                                <p class="text-sm font-semibold text-gray-900">{{getModalidadText(formData.modalidad) || '-'}}</p>
                                            </div>
                                        </div>
                                        <div class="flex items-start gap-4">
                                            <div class="bg-white p-2 rounded-lg shadow-xs border border-gray-200">
                                                <i class="fas fa-stopwatch text-gray-600"></i>
                                            </div>
                                            <div>
                                                <p class="text-xs text-gray-600 mb-1">Duración</p>
                                                <p class="text-sm font-semibold text-gray-900">60 min</p>
                                            </div>
                                        </div>
                                    </div>
                                  
                                </div>
                            </div>
                        </div>
                        
                        <!-- Botones de acción mejorados -->
                        <div class="pt-8 mt-8 border-t border-gray-200 flex flex-col sm:flex-row gap-4">
                            <button type="button" (click)="prevStep()"
                                    class="flex-1 px-6 py-3.5 border border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-all duration-200 flex items-center justify-center gap-2 hover:border-gray-300">
                                <i class="fas fa-edit"></i>
                                Editar información
                            </button>
                            <button type="button" (click)="confirmAppointment()"
                                    class="flex-1 bg-gradient-to-r from-gray-800 to-gray-900 hover:from-gray-700 hover:to-gray-800 text-white font-medium py-3.5 px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-2">
                                <i class="far fa-calendar-check"></i>
                                Confirmar asesoría
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>